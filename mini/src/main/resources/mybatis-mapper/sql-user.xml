<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	<mapper namespace="com.example.mini.mapper.UserMapper">
		<select id="selectUserInfo" parameterType="hashmap" resultType="com.example.mini.model.User">
			SELECT      
				USER_ID,
				NAME,
				NICK,
				EMAIL,
				GENDER,
				BIRTH,
				HP,
				LIVING_YEAR,
				STATUS,
				ADDR,
				ADDR2,
				JOINDATE,
				PW_Q,
				PW_A
			FROM T4_USER
			WHERE USER_ID=#{id} AND PASSWORD=#{pw}
		</select>
		
		<select id="selectUserCnt" parameterType="HashMap" resultType="int">
			SELECT COUNT(*) AS CNT 
			FROM T4_USER
			WHERE USER_ID = #{id}
		</select>
		
		<select id="selectUserNickCnt" parameterType="HashMap" resultType="int">
			SELECT COUNT(*) AS CNT 
			FROM T4_USER
			WHERE NICK = #{nick}
		</select>
		
		<insert id="insertUser" parameterType="HashMap">
			INSERT INTO T4_USER(
				USER_ID,
				PASSWORD,
				NAME,
				NICK,
				EMAIL,
				BIRTH,
				HP,
				LIVING_YEAR,
				STATUS,
				ADDR,
				ADDR2,
				JOINDATE,
				PW_Q,
				PW_A)
			VALUES(#{id}, #{pw}, #{name}, #{nick}, #{email}, #{birth},
			#{hp}, #{livingYear}, #{status}, #{addr}, #{addr2}, now(), #{pwQ}, #{pwA})
		</insert>
		
		<select id="selectUserId" parameterType="HashMap" resultType="com.example.mini.model.User">
			SELECT USER_ID 
			FROM T4_USER
			WHERE NAME = #{name} AND HP = #{hp} AND BIRTH = #{birth}
		</select>
		
		<select id="selectUserIdCnt" parameterType="HashMap" resultType="int">
			SELECT COUNT(USER_ID)  
			FROM T4_USER
			WHERE NAME = #{name} AND HP = #{hp} AND BIRTH = #{birth}
		</select>
		
		<select id="selectUserPw" parameterType="HashMap" resultType="com.example.mini.model.User">
			SELECT PASSWORD 
			FROM T4_USER 
			WHERE USER_ID = #{id} AND NAME = #{name} AND PW_Q = #{pwQ} AND PW_A = #{pwA}
		</select>
		
		<update id="updatePw" parameterType="HashMap">
			UPDATE T4_USER
			SET PASSWORD = #{pw}
			WHERE USER_ID  = #{id} AND NAME = #{name} AND PW_Q = #{pwQ} AND PW_A =#{pwA}
		</update> 
		
		<select id="selectLikeRecipe" parameterType="HashMap" resultType="com.example.mini.model.User">
			SELECT RECIPE_NAME, HASHTAG, IMG_PATH
			FROM T4_RECIPE R
			INNER JOIN 
				T4_R_IMAGE I ON R.RECIPE_NO = I.RECIPE_NO
			WHERE R.RECIPE_NO = #{recipeNo} AND THUMBNAIL_YN = 'Y'
		</select>
		
	</mapper>