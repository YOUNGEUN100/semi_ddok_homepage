<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<!--투데잇 레시피추천 리스트-->
<mapper namespace="com.example.mini.mapper.TodayEatMapper">

 	<select id="selectRecipeInfo" parameterType="hashmap" resultType="com.example.mini.model.TodayEat">
		SELECT R.RECIPE_NO, 
			   RECIPE_NAME, 
			   COOK_INGRE
		FROM T4_RECIPE AS R
		INNER JOIN T4_R_PURPOSE AS P ON R.RECIPE_NO = P.RECIPE_NO
		INNER JOIN T4_HOWTO AS H ON R.RECIPE_NO = H.RECIPE_NO
		INNER JOIN T4_INGREDIENT AS I ON R.RECIPE_NO = I.RECIPE_NO
		INNER JOIN T4_TOOL AS T ON R.RECIPE_NO = T.RECIPE_NO
		WHERE P.CODE = #{r_purpose} AND
			  H.CODE = #{howto} AND
			  <!-- I.CODE IN (#{ingredient}) AND -->
			  I.CODE IN
			  	<foreach collection="ingredient"  index="index" item="item" open="(" close=")" separator=",">
					#{item}
				</foreach> AND
			  T.CODE = #{tool}
		ORDER BY RAND() LIMIT 1
	</select>
	
</mapper>